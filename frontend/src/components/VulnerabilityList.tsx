import { AlertTriangle, CheckCircle, ChevronRight } from 'lucide-react';
import { Vulnerability } from '../services/api';
import { Badge } from './ui/Badge';
import { Button } from './ui/Button';

interface VulnerabilityListProps {
    vulnerabilities: Vulnerability[];
    onRemediate: (vuln: Vulnerability) => void;
}

export function VulnerabilityList({ vulnerabilities, onRemediate }: VulnerabilityListProps) {
    if (vulnerabilities.length === 0) {
        return (
            <div className="text-center py-10 text-gray-500">
                <CheckCircle className="mx-auto mb-3 text-green-500/50" size={40} />
                <p>No vulnerabilities found.</p>
            </div>
        );
    }

    return (
        <div className="space-y-3">
            {vulnerabilities.map((vuln, idx) => (
                <div key={idx} className="bg-white/[0.02] border border-white/5 rounded-lg p-4 hover:bg-white/[0.04] transition-colors group">
                    <div className="flex justify-between items-start">
                        <div className="flex gap-3">
                            <div className={`mt-1 p-1.5 rounded-md ${vuln.severity === 'Critical' || vuln.severity === 'High'
                                ? 'bg-red-500/10 text-red-400'
                                : 'bg-yellow-500/10 text-yellow-400'
                                }`}>
                                <AlertTriangle size={16} />
                            </div>
                            <div>
                                <div className="flex items-center gap-2 mb-1">
                                    <h4 className="text-sm font-medium text-gray-200">{vuln.title}</h4>
                                    <Badge variant={
                                        vuln.severity === 'Critical' ? 'destructive' :
                                            vuln.severity === 'High' ? 'warning' :
                                                'secondary'
                                    }>
                                        {vuln.severity}
                                    </Badge>
                                    {vuln.category && (
                                        <Badge variant="outline" className="text-blue-300 border-blue-500/30">
                                            {vuln.category}
                                        </Badge>
                                    )}
                                </div>
                                <p className="text-xs text-gray-500 line-clamp-2">{vuln.description}</p>
                            </div>
                        </div>
                        <Button
                            size="sm"
                            variant="outline"
                            onClick={() => onRemediate(vuln)}
                            className="text-blue-400 border-blue-500/30 hover:bg-blue-500/10"
                        >
                            Fix with AI <ChevronRight size={12} className="ml-1" />
                        </Button>
                    </div>
                </div>
            ))}
        </div>
    );
}
